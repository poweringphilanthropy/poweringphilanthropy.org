/*!  1.6.7 2018-12-06 17:14 */

CHARITABLE=window.CHARITABLE||{},function(t,u){var e=function(t){this.errors=[],this.form=t,this.pause_processing=!1,this.submit_processing=!1;var e=this,r=u("body"),i=function(){return e.form.find(".charitable-terms-text").addClass("active"),!1},o=function(){u(this).closest("li").trigger("click").find("input[name=donation_amount]").prop("checked",!0).trigger("change"),e.form.off("focus","input.custom-donation-input",o),u(this).focus(),e.form.on("focus","input.custom-donation-input",o)},n=function(){var t=e.unformat_amount(u(this).val());0<u.trim(t)&&u(this).val(e.format_amount(t))},a=function(){var t=u(this).closest("li");t.hasClass("selected")||(t.parents(".charitable-donation-form").find(".donation-amount.selected").removeClass("selected"),t.addClass("selected"),t.hasClass("custom-donation-amount")&&t.find("input.custom-donation-input").focus())},s=function(){e.hide_inactive_payment_methods(),e.show_active_payment_methods(u(this).val())},c=function(t){var e=t.data.helper;return!e.submit_processing&&(e.submit_processing=!0,e.show_processing(),!1===e.validate()?(e.hide_processing(),e.print_errors(),e.scroll_to_top(),!1):!1===e.pause_processing&&(1!==e.form.data("use-ajax")||(r.trigger("charitable:form:process",e),!1)))},d=function(t,i){var e=i.get_data();i.form;return e.action="make_donation",e.form_action=e.charitable_action,delete e.charitable_action,u.ajax({type:"POST",data:e,dataType:"json",url:CHARITABLE_VARS.ajaxurl,timeout:0,xhrFields:{withCredentials:!0},success:function(t){t.success?window.location.href=t.redirect_to:(i.hide_processing(),i.print_errors(t.errors),i.scroll_to_top(),t.donation_id&&i.set_donation_id(t.donation_id))}}).fail(function(t,e,r){window.console&&window.console.log&&console.log(t),i.hide_processing(),i.print_errors([CHARITABLE_VARS.error_unknown]),i.scroll_to_top()}),!1};e.form.on("click",".donation-amount",a),e.form.on("focus","input.custom-donation-input",o),e.form.on("click",".charitable-terms-link",i),e.form.on("blur",".custom-donation-input",n),e.form.find(".donation-amount input:checked").each(function(){u(this).closest("li").addClass("selected")}),e.get_all_payment_methods().length&&(e.hide_inactive_payment_methods(),e.form.on("change","#charitable-gateway-selector input[name=gateway]",s)),e.form.on("submit",{helper:e},c),!1===CHARITABLE.forms_initialized&&(r.on("charitable:form:process",d),r.trigger("charitable:form:initialize",e),CHARITABLE.forms_initialized=!0),r.trigger("charitable:form:loaded",e)};e.prototype.get_input=function(t){return this.form.find("[name="+t+"]")},e.prototype.get_email=function(){return this.form.find("[name=email]").val()},e.prototype.get_suggested_amount=function(){return accounting.unformat(this.form.find("[name=donation_amount]:checked, input[type=hidden][name=donation_amount]").val(),CHARITABLE_VARS.currency_format_decimal_sep)},e.prototype.get_custom_amount=function(){var t=this.form.find(".charitable-donation-options.active .custom-donation-input");return 0===t.length&&(t=this.form.find(".custom-donation-input")),accounting.unformat(t.val(),CHARITABLE_VARS.currency_format_decimal_sep)},e.prototype.get_amount=function(){return this.get_suggested_amount()||this.get_custom_amount()},e.prototype.get_description=function(){return this.form.find("[name=description]").val()||""},e.prototype.get_cc_number=function(){return this.form.find("#charitable_field_cc_number input").val()||""},e.prototype.get_cc_cvc=function(){return this.form.find("#charitable_field_cc_cvc input").val()||""},e.prototype.get_cc_expiry_month=function(){return this.form.find("#charitable_field_cc_expiration select.month").val()||""},e.prototype.get_cc_expiry_year=function(){return this.form.find("#charitable_field_cc_expiration select.year").val()||""},e.prototype.clear_cc_fields=function(){this.form.find("#charitable_field_cc_number input, #charitable_field_cc_name input, #charitable_field_cc_cvc input, #charitable_field_cc_expiration select").removeAttr("name")},e.prototype.get_payment_method=function(){return this.form.find("[type=hidden][name=gateway], [name=gateway]:checked").val()||""},e.prototype.get_all_payment_methods=function(){return this.form.find("#charitable-gateway-selector input[name=gateway]")},e.prototype.hide_inactive_payment_methods=function(){var t=this.get_payment_method(),e=this.form.find(".charitable-gateway-fields[data-gateway!="+t+"]");e.hide(),e.find("input[required],select[required],textarea[required]").attr("data-required",1).attr("required",!1)},e.prototype.show_active_payment_methods=function(t){t=t||this.get_payment_method();var e=this.form.find(".charitable-gateway-fields[data-gateway="+t+"]");e.show(),e.find("[data-required]").attr("required",!0)},e.prototype.format_amount=function(t,e){return void 0===e&&(e=""),accounting.formatMoney(t,{symbol:e,decimal:CHARITABLE_VARS.currency_format_decimal_sep,thousand:CHARITABLE_VARS.currency_format_thousand_sep,precision:CHARITABLE_VARS.currency_format_num_decimals,format:CHARITABLE_VARS.currency_format}).trim()},e.prototype.unformat_amount=function(t){return Math.abs(parseFloat(accounting.unformat(t,CHARITABLE_VARS.currency_format_decimal_sep)))},e.prototype.add_error=function(t){this.errors.push(t)},e.prototype.get_errors=function(){return this.errors},e.prototype.get_error_message=function(){return this.errors.join(" ")},e.prototype.print_errors=function(t){var e=t||this.errors,r="";0!==e.length&&(this.form.find(".charitable-form-errors").length&&this.form.find(".charitable-form-errors").remove(),r+='<div class="charitable-form-errors charitable-notice"><ul class="errors"><li>',r+=e.join("</li><li>"),r+="</li></ul></div>",this.form.prepend(r))},e.prototype.clear_errors=function(){this.errors=[],this.form.find(".charitable-form-errors").length&&this.form.find(".charitable-form-errors").remove()},e.prototype.show_processing=function(){this.form.find(".charitable-form-processing").show(),this.form.find('button[name="donate"]').hide()},e.prototype.hide_processing=function(){this.form.find(".charitable-form-processing").hide(),this.form.find('button[name="donate"]').show(),this.submit_processing=!1,this.pause_processing=!1},e.prototype.scroll_to_top=function(){var t=this.form.parents(".charitable-modal");t.length?t.scrollTop(0):window.scrollTo(this.form.position().left,this.form.position().top)},e.prototype.set_donation_id=function(t){this.form.find("[name=ID]").val(t)},e.prototype.get_data=function(){return this.form.serializeArray().reduce(function(t,e){if("[]"===e.name.slice(-2)){var r=e.name.slice(0,-2);t.hasOwnProperty(r)||(t[r]=[]),t[r].push(e.value)}else t[e.name]=e.value;return t},{})},e.prototype.get_required_fields=function(){var t=this.form.find(".charitable-fieldset .required-field").not("#charitable-gateway-fields .required-field"),e=this.get_payment_method();if(""!==e){var r=this.form.find("[data-gateway="+e+"] .required-field");r.length&&(t=u.merge(t,r))}return t},e.prototype.is_valid_amount=function(){var t=parseFloat(CHARITABLE_VARS.minimum_donation);return this.get_amount()>=t},e.prototype.validate_amount=function(){return!1!==this.is_valid_amount()||(this.add_error(CHARITABLE_VARS.error_invalid_amount),!1)},e.prototype.validate_required_fields=function(){var t=!0;this.get_required_fields();return this.get_required_fields().each(function(){""===u(this).find("input, select, textarea").val()&&(t=!1)}),t||this.add_error(CHARITABLE_VARS.error_required_fields),t},e.prototype.validate=function(){return this.clear_errors(),this.validate_amount(),this.validate_required_fields(),this.form.trigger("charitable:form:validate",this),0===this.errors.length},t.Donation_Form=e}(CHARITABLE,jQuery),function(o,n){o.Toggle=function(){var t=function(){r(n(this)).addClass("charitable-hidden")},r=function(t){var e=t.data("charitable-toggle");return"."!==e[0]&&"#"!==e[0]&&(e="#"+e),n(e)},e=function(){n("[data-charitable-toggle]").each(t)};if(n("body").on("click","[data-charitable-toggle]",function(){var t=n(this),e=r(t);return e.toggleClass("charitable-hidden",t.is(":checkbox")?!t.is(":checked"):!1===e.hasClass("charitable-hidden")),!1}),o.content_loading)var i=setInterval(function(){!1===o.content_loading&&(e(),clearInterval(i))},500);return e}()}(CHARITABLE,jQuery),CHARITABLE,jQuery,CHARITABLE.SanitizeURL=function(t){CHARITABLE.Helpers.sanitize_url(t)},function(t){CHARITABLE.forms_initialized=!1,t(document).ready(function(){t("html").addClass("js"),t(".charitable-donation-form").each(function(){new CHARITABLE.Donation_Form(t(this))}),CHARITABLE.Toggle()})}(jQuery);